import"./faceplate-expandable-section-helper-786f5daf.js";import"./faceplate-shimmer-2aa9ab87.js";import{W as t,f as e,l as i,e_ as a,aG as s,aH as r,q as o,g as n,k as d,a as l,b as c,c as h,_ as p,n as u,e as m,J as v,t as f}from"./shell-ceb66a5c.js";import{x as g,y as F,I as S,bO as y,bP as b,s as N,ax as C}from"./icon-04f6a077.js";import{l as k,L as $}from"./list-item-b879d870.js";import{C as x,a as P}from"./index-6b599370.js";import"./custom-feed-edit-button-4d2ef574.js";let _=class extends(t(e(N))){constructor(){super(...arguments),this.multiredditPath="",this.displayName="",this.iconSrc="",this.isFavorited=!1,this.sanNoun="",this.getTrackingContext=()=>({customFeed:{id:this.multiredditPath}}),this.onFavoriteClick=async()=>{this.trackEvent(i({source:"community_nav",action:"click",noun:this.isFavorited?"unfavorite":"favorite"},this.getTrackingContext()));try{const t={input:{label:this.multiredditPath,favoriteState:this.isFavorited?a.None:a.Favorited}},{data:e}=await s({operation:r.UpdateMultiredditFavoriteState,variables:t});if(e.updateMultiredditFavoriteState?.ok){const t={path:this.multiredditPath,isFavorited:!this.isFavorited};return void this.publish(o.MultiredditFavoriteStatusChange,t)}throw new Error("error updating custom feed favorite status")}catch(t){const e=this.isFavorited?`Failed to remove ${this.displayName} from favorites`:`Failed to add ${this.displayName} to favorites`;this.dispatchEvent(n("faceplate-alert",{level:d.error,message:e}))}}}static get styles(){return[l]}updated(t){}render(){const t=g`<span class="mr-[2px]" \n>${this.iconSrc?g`<img \n class="rounded-full" \n loading="lazy" \n src="${this.iconSrc}" \n width="32" \n height="32" \n aria-hidden="true" \n alt="custom feed icon" \n>`:F({size:S.Large})}</span>`;return g`<faceplate-tracker \n source="${"community_nav"}" \n action="click" \n noun="custom_feed" \n data-faceplate-tracking-context="${JSON.stringify(this.getTrackingContext())}" \n>${k({href:this.multiredditPath,innerClassName_DO_NOT_USE:"s:rounded-[8px] bg-transparent",label:g`<div class="truncate">${this.displayName}</div>`,leadingAvatar:t,size:$.Small,trailingSlot:g` ${c({appearance:"plain",leadingIcon:(this.isFavorited?y:b)({size:S.Small}),size:h.Small,attributes:{"aria-label":this.isFavorited?"Remove custom feed from favorites":"Add custom feed to favorites",onclick:t=>{t.preventDefault(),t.stopPropagation(),this.onFavoriteClick()}}})}`})}</faceplate-tracker>`}};p([u({type:String})],_.prototype,"multiredditPath",void 0),p([u({type:String})],_.prototype,"displayName",void 0),p([u({type:String})],_.prototype,"iconSrc",void 0),p([u({type:Boolean})],_.prototype,"isFavorited",void 0),p([u({type:String})],_.prototype,"sanNoun",void 0),_=p([m("left-nav-multireddit-item")],_);class w extends(e(N)){constructor(){super(),this.initialStateJSON="[]",this.items=[],this.triggerReload=()=>{this.dispatchEvent(new CustomEvent(x))},this.updateFavoritedState=({path:t,isFavorited:e})=>{const i=[...this.items],a=i.findIndex((e=>e.path===t));-1!==a&&i[a].isFavorited!==e&&(i[a].isFavorited=e,this.items=O(i))},this.reloadController=new P(this,{reloadUrl:"/svc/shreddit/left-nav-multireddits-section",containerSelector:"left-nav-multireddits-controller",mode:v.Replace})}connectedCallback(){super.connectedCallback(),this.items=O(JSON.parse(this.initialStateJSON)),this.subscribe(o.MultiredditFavoriteStatusChange,this.updateFavoritedState),this.subscribe(o.CustomFeedUpdated,this.triggerReload,!1),this.subscribe(o.CustomFeedCreated,this.triggerReload,!1),this.subscribe(o.CustomFeedDeleted,this.triggerReload,!1)}render(){return g`<div>\n ${this.reloadController?.isLoading?g`<shreddit-loading></shreddit-loading>`:g`${C(this.items,(t=>g`<left-nav-multireddit-item \n sanNoun="${this.sanNoun}" \n multiredditPath="${t.path}" \n displayName="${t.displayName}" \n iconSrc="${t.icon}" \n ?isFavorited="${t.isFavorited}" \n></left-nav-multireddit-item>`))}`}\n </div>`}}function O(t){return[...t.sort(((t,e)=>t.isFavorited===e.isFavorited?t.displayName.toLowerCase()>e.displayName.toLowerCase()?1:-1:t.isFavorited?-1:1))]}p([u({type:String})],w.prototype,"initialStateJSON",void 0),p([f()],w.prototype,"items",void 0);let j=class extends w{constructor(){super(...arguments),this.sanNoun="multireddits_menu"}};j=p([m("left-nav-multireddits-controller")],j);
//# sourceMappingURL=left-nav-multireddits-section-client-js-2eadd487.js.map
